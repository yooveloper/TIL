# 14장 전역변수의 문제점

# ✅ 변수의 생명주기

변수는 생성과 소멸이라는 라이프사이클이 있다.

전역변수의 생명주기는 애플리케이션의 라이프사이클과 같고,

함수 내부에 선언된 지역변수는 함수가 호출되면 생성되고 종료하면 소멸한다.

 

```jsx
**[ 예제 14-01 ]

function foo() {
	var x = 'local';
	console.log(x); // local
	return x;
}

foo();

console.log(x); // 지역 변수 x는 foo 함수가 호출되기 이전까지는 생성되지 않는다.**
```

```jsx
**[ 예제 14-02 ]

var x = 'glocal';

function foo() {
	console.log(x); // 1
	var x = 'local';
}

foo();
console.log(x); ??** 

```

foo함수 내부의 지역변수 x는  1의 시점에 이미 undefined으로 초기화 되어 있음.

즉 해당 스코프 내에서 전역변수 x의 값을 참조하는게 아니라 지역변수 x의 값을 참조해서 출력한다.

**호이스팅은 스코프를 단위로 동작한다**

호이스팅은 변수 선언이 스코프의 선두로 끌어올려진것처럼 동작하는 자바스크립트 고유의 특징

# ✅ 전역 변수의 생명 주기

함수와 달리 전역변수는 명시적 호출없이 실행됨.

함수는 함수몸체의 마지막문 또는 반환문을 통해 종료하지만, 전역코드에는 반환문이 없으므로 

마지막 문이 실행되서 더 이상 실행할게 없을때 종료됨.

var 키워드로 선언한 변수는 전역 객체의 프로퍼티가 되므로 전역변수의 생명주기는 전역객체의 생명주기와 일치한다.

**전역 객체**

전역객체는 코드가 실행되기 이전 단계에 자바스크립트 엔진에 의해 어떠한 객체보다도 먼저 생성되는 특수한 객체

전역객체는 클라이언트 사이드 환경에서는 window , 서버사이드 환경에서는 global 객체를 의미.

21장에서 알아보자.

# ✅ 14.2 전역 변수의 문제점

1. 암묵적 결합 : 전역변수를 선언한 의도는 코드 어디서든 참조하고 할당할 수 있는 변수를 사용하겠다는 것.

모든 코드가 전역변수를 참조하고 변경할 수 있는 암묵적 결합을 허용하는것.

1. 긴 생명 주기 : 전역변수는 생명주기가 길다. 메모리 점유를 오래하고 있기때문에 비효율적임.
2. 스코프 체인 상에서 종점에 존재 : 전역 변수는 스코프 체인 상에서 종점에 존재한다. 변수를 검색할때 가장 마지막에 검색되므로 검색속도가 가장 느리다.
3. 네임스페이스의 오염 : 파일이 분리되어 있어도 하나의 전역스코프를 공유한다. 무슨말이냐면 다른 파일 내에서 같은 이름으로 명명된 전역 변수나 함수가 같은 스코프내에 존재하는게 가능하며, 예상치못한 오류를 만들수있다.

# ✅ 14.3 전역 변수의 사용을 억제하는 방법

전역 변수를 반드시 사용해야 할 이유를 찾지 못한다면 지역 변수를 사용해야 한다. 변수의 스코프는 좁을수록 좋다.

1. 즉시실행함수

```jsx
[ 예제 14-04 ]
```

1. 네임스페이스 객체

```jsx
[ 예제 14-05 ]

[예제 14-06 ]
```

1. 모듈패턴 → 클로저패턴에서 배움

```jsx
[ 예제 14-07 ]
```

1. es6 모듈 : es6모듈을 사용하면 전역변수를 사용할수없음, es6모듈은 파일 자체의 독자적인 모듈 스코프를 제공한다.

```jsx
[ 예제 14-08 ]
```